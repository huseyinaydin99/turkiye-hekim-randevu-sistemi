<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Geçmiş Randevularım</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h1>Geçmiş Randevularım</h1>

    <div class="mb-3">
        <a th:href="@{/appointments/myAppointments}" class="btn btn-secondary">Tüm Randevular</a>
        <a th:href="@{/appointments/upcoming}" class="btn btn-primary">Aktif Randevular</a>
    </div>

    <!-- Randevu Listesi -->
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Tarih & Zaman</th>
            <th>Doktor</th>
            <th>Klinik</th>
            <th>Hastane</th>
            <th>Konum</th>
            <th>Durum</th>
            <th>Olay</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="appointment : ${appointments.content}">
            <td th:text="${#temporals.format(appointment.appointmentDateTime, 'dd/MM/yyyy HH:mm')}"></td>
            <td th:text="${appointment.doctor.fullName}"></td>
            <td th:text="${appointment.clinic.name}"></td>
            <td th:text="${appointment.hospital.name}"></td>
            <td>
                <span th:text="${appointment.district.name}"></span>,
                <span th:text="${appointment.city.name}"></span>
            </td>
            <td>
                <span th:if="${appointment.attended}" class="badge bg-success">Daha önce geldim.</span>
                <span th:unless="${appointment.attended}" class="badge bg-danger">Daha önce gelmedim.</span>
            </td>
            <td>
                <a th:href="@{/appointments/details/{id}(id=${appointment.id})}"
                   class="btn btn-info btn-sm">Detaylar</a>
            </td>
        </tr>
        <tr th:if="${appointments.content.isEmpty()}">
            <td colspan="7" class="text-center">Geçmiş randevularınız bulunamadı!</td>
        </tr>
        </tbody>
    </table>

    <!-- Sayfalama Navigasyonu -->
    <div th:if="${appointments.totalPages > 1}" class="row">
        <div class="col">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    <!-- İlk Sayfa -->
                    <li class="page-item" th:classappend="${appointments.first} ? 'disabled' : ''">
                        <a class="page-link" th:href="@{/appointments/past(page=0, size=${appointments.size})}">İlk</a>
                    </li>

                    <!-- Önceki Sayfa -->
                    <li class="page-item" th:classappend="${appointments.first} ? 'disabled' : ''">
                        <a class="page-link"
                           th:href="@{/appointments/past(page=${appointments.number-1}, size=${appointments.size})}">
                            Önceki
                        </a>
                    </li>

                    <!-- Sayfa Numaraları -->
                    <li th:each="page : ${#numbers.sequence(0, appointments.totalPages-1)}"
                        class="page-item"
                        th:classappend="${appointments.number == page} ? 'active' : ''">
                        <a class="page-link"
                           th:href="@{/appointments/past(page=${page}, size=${appointments.size})}"
                           th:text="${page+1}"></a>
                    </li>

                    <!-- Sonraki Sayfa -->
                    <li class="page-item" th:classappend="${appointments.last} ? 'disabled' : ''">
                        <a class="page-link"
                           th:href="@{/appointments/past(page=${appointments.number+1}, size=${appointments.size})}">
                            Sonraki
                        </a>
                    </li>

                    <!-- Son Sayfa -->
                    <li class="page-item" th:classappend="${appointments.last} ? 'disabled' : ''">
                        <a class="page-link"
                           th:href="@{/appointments/past(page=${appointments.totalPages-1}, size=${appointments.size})}">
                            Son
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- Sayfa Boyutu Seçimi -->
    <div class="row mt-2">
        <div class="col text-center">
            <div class="btn-group" role="group">
                <a th:each="size : ${pageSizes}"
                   class="btn btn-outline-secondary"
                   th:classappend="${appointments.size == size} ? 'active' : ''"
                   th:href="@{/appointments/past(page=0, size=${size})}"
                   th:text="${size}"></a>
            </div>
            <small class="text-muted d-block mt-1">Sayfa başına öğe sayısı.</small>
        </div>
    </div>

    <!-- Toplam Bilgisi -->
    <div class="row mt-3">
        <div class="col text-center">
            <p class="text-muted">
                Gösteriliyor <span th:text="${appointments.number * appointments.size + 1}"></span> /
                <span th:text="${appointments.number * appointments.size + appointments.numberOfElements}"></span> |
                <span th:text="${appointments.totalElements}"></span> randevu.
            </p>
        </div>
    </div>
</div>
</body>
</html>